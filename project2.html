<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
    <title>Generic Page - Massively by HTML5 UP</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
    <style>
        .add-spacing {
            margin-left: 10px;
            /* Adjust the value as needed */
        }
    </style>
    <style>
        .add-spacing2 {
            margin-left: 50px;
            /* Adjust the value as needed */
        }
    </style>
</head>

<body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Header -->
        <header id="header">
        </header>

        <!-- Nav -->
        <nav id="nav">
            <ul class="links">
                <li class="active"><a href="index.html">Projects</a></li>
                <li class="active"><a href="project2.html">Examine alerts, logs, and rules with Suricata</a></li>
            </ul>
            <ul class="icons">
                <li><a href="https://www.linkedin.com/in/dzhaner-mustafov-229364284/" class="icon brands fa-linkedin"><span class="label">Instagram</span></a></li>
                <li><a href="https://github.com/reverseshells" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
            </ul>
        </nav>

        <!-- Main -->
        <div id="main">

            <!-- Post -->
            <section class="post">
                <header class="major">
                    <h1>Examine alerts, logs, and rules with Suricata</h1>
                </header>

                <p><strong>Scenario</strong></p>
                <p>
                    In this scenario, you’re a security analyst who must monitor traffic on your employer's network. You’ll be required to configure Suricata and use it to trigger alerts.<br> Here’s how you'll do this task: <strong>First</strong>, you'll
                    explore custom rules in Suricata. <strong>Second</strong>you'll run Suricata with a custom rule in order to trigger it, and examine the output logs in the fast.log file.
                    <strong>Finally</strong>, you’ll examine the additional output that Suricata generates in the standard eve.json log file.<br> For the purposes of the tests you’ll run in this lab activity, you’ve been supplied with a sample.pcap file
                    and a custom.rules file. These reside in your home folder.<br> Let’s define the files you’ll be working with in this lab activity:<br> 1⦁ The sample.pcap file is a packet capture file that contains an example of network traffic data,
                    which you’ll use to test the Suricata rules. This will allow you to simulate and repeat the exercise of monitoring network traffic.<br> 2⦁ The custom.rules file contains a custom rule when the lab activity starts. You’ll add rules
                    to this file and run them against the network traffic data in the sample.pcap file.<br> 3⦁ The fast.log file will contain the alerts that Suricata generates. The fast.log file is empty when the lab starts. Each time you test a rule,
                    or set of rules, against the sample network traffic data, Suricata adds a new alert line to the fast.log file when all the conditions in any of the rules are met. The fast.log file can be located in the /var/log/suricata directory
                    after Suricata runs.The fast.log file is considered to be a depreciated format and is not recommended for incident response or threat hunting tasks but can be used to perform quick checks or tasks related to quality assurance.<br>                    4⦁ The eve.json file is the main, standard, and default log for events generated by Suricata. It contains detailed information about alerts triggered, as well as other network telemetry events, in JSON format. The eve.json file is
                    generated when Suricate runs, and can also be located in the /var/log/suricata directory. When you create a new rule, you'll need to test the rule to confirm whether or not it worked as expected. You can use the fast.log file to quickly
                    compare the number of alerts generated each time you run Suricata to test a signature against the sample.pcap file.
                </p>
                <p>
                    <strong>Task 1. Examine a custom rule in Suricata</strong><br>The /home/analyst directory contains a custom.rules file that defines the network traffic rules, which Suricata captures.<br> I used cat custom.rules to explore the composition
                    of the Suricata rule defined in the custom.rules file.<br>
                    <a><img src="images/pic1.PNG" alt="" /></a><br> Actions differ across network intrusion detection system (NIDS) rule languages, but some common actions are alert, drop, pass, and reject.<br> Using our example, the file contains a single
                    alert as the action. The alert keyword instructs to alert on selected network traffic. The IDS will inspect the traffic packets and send out an alert in case it matches.<br>
                    <strong>1⦁	alert http: </strong>: Indicates that this is an HTTP-related alert.<br>
                    <strong>2⦁	$HOME_NET any -> $EXTERNAL_NET any: </strong>Specifies the flow direction. In this case, it's from any src IP <strong>$HOME_NET </strong> on <strong>any</strong> port to dst IP <strong>$EXTERNAL_NET</strong> on <strong>any</strong>                    port.<br>
                    <strong>3⦁	msg:"GET on wire":</strong> Provides a human-readable message associated with the alert.<br> 4⦁ The <strong>flow:established</strong> ,to_server option determines that packets from the client to the server should be matched.
                    (In this instance, a server is defined as the device responding to the initial SYN packet with a SYN-ACK packet.)<br>
                    <strong>5⦁	content:"GET"</strong>": This is the content match condition. It looks for the presence of "GET" in the payload, indicating an HTTP GET request.<br>
                    <strong>6⦁	http_method: </strong>Indicates that the content match is specifically looking for an HTTP method.<br>
                    <strong>7⦁	sid:12345</strong>: Represents the unique identifier for this signature. In this case, it's assigned the ID 12345<br>
                    <strong>8⦁	rev:3: </strong>Indicates the revision number of this signature.<br>
                </p>
                <p>
                    <strong>Task 2. Trigger a custom rule in Suricata</strong><br>
                    <a><img src="images/pic2.PNG" alt="" /></a><br> Note that before i ran Suricata, there were no files in the /var/log/suricata directory.<br> This command starts the Suricata application and processes the sample.pcap file using the rules
                    in the custom.rules file. It returns an output stating how many packets were processed by Suricata.<br> ⦁ The -r sample.pcap option specifies an input file to mimic network traffic. In this case, the sample.pcap file.<br> ⦁ The -S
                    custom.rules option instructs Suricata to use the rules defined in the custom.rules file.<br> ⦁ The -k none option instructs Suricata to disable all checksum checks.<br>
                    <a><img src="images/pic4.PNG" alt="" /></a><br> Note that after running Suricata, there are now four files in the /var/log/suricata directory, including the fast.log and eve.json files.<br> Each line or entry in the fast.log file corresponds
                    to an alert generated by Suricata when it processes a packet that meets the conditions of an alert generating rule. Each alert line includes the message that identifies the rule that triggered the alert, as well as the source, destination,
                    and direction of the traffic.
                </p>
                <p>
                    <strong>
                        Task 3. Examine eve.json output<br>
                    </strong>
                    <a><img src="images/pic3.PNG" alt="" /></a><br> The output returns the raw content of the file.<br>
                    <a><img src="images/pic5.PNG" alt="" /></a><br>
                    <a><img src="images/pic6.PNG" alt="" /></a><br>
                </p>
            </section>

        </div>


    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>

</body>

</html>